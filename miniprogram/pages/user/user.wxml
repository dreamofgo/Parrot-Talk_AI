<view class="user-container">
  <!-- æœªç™»å½•çŠ¶æ€ -->
  <view class="user-info" wx:if="{{!isLoggedIn}}">
    <view class="user-header">
      <button class="avatar-wrapper" open-type="chooseAvatar" bindchooseavatar="onChooseAvatar">
        <image class="avatar" src="{{avatarUrl}}"></image>
      </button>
      <view class="user-detail">
        <input 
          type="nickname" 
          class="nickname-input" 
          placeholder="è¯·è¾“å…¥æ˜µç§°"
          placeholder-class="input-placeholder"
          bindchange="onInputNickname"
        />
        <button 
          class="login-btn" 
          bindtap="handleLogin"
          loading="{{isLoading}}">
          ç¡®è®¤ç™»å½•
        </button>
      </view>
    </view>
  </view>

  <!-- å·²ç™»å½•çŠ¶æ€ -->
  <view class="user-info" wx:else>
    <view class="user-header">
      <view class="header-bg"></view>
      <view class="user-info-content">
        <image class="avatar" src="{{userInfo.avatarUrl}}" mode="aspectFill" />
        <view class="user-detail">
          <view class="nickname">{{userInfo.nickName || 'å¾®ä¿¡ç”¨æˆ·'}}</view>
        </view>
      </view>
    </view>
    
    <!-- æ•°æ®ç»Ÿè®¡å¡ç‰‡ -->
    <view class="stats-card">
      <view class="stat-item">
        <text class="stat-num">{{documentCount}}</text>
        <text class="stat-label">æ–‡æ¡£æ•°é‡</text>
      </view>
      <view class="stat-item">
        <text class="stat-num">{{chatCount}}</text>
        <text class="stat-label">å¯¹è¯æ¬¡æ•°</text>
      </view>
    </view>

    <!-- æœ€è¿‘æ–‡æ¡£ -->
    <view class="section-card" wx:if="{{recentDocuments.length > 0}}">
      <view class="section-header">
        <view class="section-icon">ğŸ“‹</view>
        <text class="section-title">æœ€è¿‘æ–‡æ¡£</text>
      </view>
      <view class="doc-list">
        <view class="doc-item" wx:for="{{recentDocuments}}" wx:key="_id">
          <view class="doc-info">
            <text class="doc-name">{{item.name}}</text>
            <text class="doc-time">{{item.uploadTime}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- æœ€è¿‘å¯¹è¯ -->
    <view class="section-card" wx:if="{{recentChats.length > 0}}">
      <view class="section-header">
        <view class="section-icon">ğŸ’­</view>
        <text class="section-title">æœ€è¿‘å¯¹è¯</text>
      </view>
      <view class="chat-list">
        <view class="chat-item" wx:for="{{recentChats}}" wx:key="_id">
          <text class="chat-content">{{item.content}}</text>
          <text class="chat-time">{{item.createTime}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- æˆæƒå¼¹çª— -->
  <view class="auth-modal" wx:if="{{isShowAuth}}">
    <view class="auth-content">
      <view class="auth-title">ç”³è¯·è·å–ä»¥ä¸‹æƒé™</view>
      <view class="auth-subtitle">è·å¾—ä½ çš„å…¬å¼€ä¿¡æ¯(æ˜µç§°ã€å¤´åƒç­‰)</view>
      <view class="auth-item">
        <image class="wechat-icon" src="/images/wechat.png" />
        <view class="auth-info">
          <view class="auth-name">å¾®ä¿¡æˆæƒç™»å½•</view>
          <view class="auth-desc">è·å¾—ä½ çš„å…¬å¼€ä¿¡æ¯</view>
        </view>
        <image class="check-icon" src="/images/check.png" />
      </view>
      <button 
        class="confirm-btn" 
        bindtap="handleGetUserProfile"
        loading="{{isLoading}}">
        ç¡®å®š
      </button>
      <view class="cancel-btn" bindtap="handleCancel">å–æ¶ˆ</view>
    </view>
  </view>
</view> 